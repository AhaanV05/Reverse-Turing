<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reverse Turing</title>
    <link rel="stylesheet" href="/static/output.css?v=2">

</head>

<body class="bg-mattblack overflow-hidden relative z-50">
    <div class="flex z-40 w-screen h-screen justify-center place-items-center">
        <p class="text-neongreen font-pixelify text-xl md:text-4xl">
            Finding you an AI or Human<span id="dotdotdot"></span>
        </p>
    </div>


    <script>
        let dots = 0;
        setInterval(() => {
            dots++;
            if (dots > 3) {
                dots = 0;
            }
            document.getElementById('dotdotdot').innerText = '.'.repeat(dots);
        }, 500);
    </script>

    <script>
        function startMatchMaking(){
            fetch("/api/match-making")
            .then(
                response => {
                    console.log(response.json());
            })

        }
        startMatchMaking();

        function activelyCheckForMatch(){
            fetch("/api/match-status")
            .then(
                response => {
                    if (response.redirected) {
                        window.location.href = response.url;
                        return;
                    }
                    response.json().then(data => {
                        if(response.status === 200){
                            window.location.href = "/chat/" + data.room;
                        }else{
                            console.log("No match found yet. Still looking for one...");
                        }
                    }).catch(() => {
                        if (response.status === 401) {
                            window.location.href = "/login";
                        }
                    })
            })
        }
        setInterval(activelyCheckForMatch, 3000);
    </script>
    
</body>

</html>
